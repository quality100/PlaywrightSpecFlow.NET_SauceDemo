pipeline{
    agent{
        docker{
            image 'mcr.microsoft.com/playwright/dotnet:v1.25.0-focal'
        }     
    }
    stages{
        stage('install playwright'){
            steps{
                sh '''
                WORKDIR /src
                COPY ["playwright_specflow/playwright_specflow.csproj", "playwright_specflow/"]
                RUN dotnet restore "playwright_specflow/playwright_specflow.csproj"
                COPY . .
                WORKDIR "/src/playwright_specflow"
                RUN dotnet build "playwright_specflow.csproj" -c Release -o /app/build
                '''
                sh 'pwsh playwright_specflow/bin/Debug/net6.0/playwright.ps1 install --with-deps'
            }
        }
        stage('Tests Run'){
             steps{
              sh 'dotnet Test' 
            }
        }
    }
}